---
phase: 05-wizard-ui
plan: 03
type: execute
wave: 3
depends_on: ["05-01", "05-02"]
files_modified:
  - public/css/style.css
autonomous: false

must_haves:
  truths:
    - "Only the active wizard step section is visible -- all hidden sections have display:none"
    - "The wizard navigation buttons (Weiter/Zuruck) are at least 48px tall with large tap areas"
    - "All progress step indicators are at least 44px x 44px (up from 28px)"
    - "Product image cards display correctly with image above text, proper sizing"
    - "Radio cards in a grid reflow to 2 columns on tablet (<=1024px) and 1 column on phone (<=768px)"
    - "No horizontal scrolling occurs on iPad (1024px wide) or Surface (1368px wide)"
    - "Wizard field error messages are styled and visible in red near the field"
    - "The progress bar reflects wizard step completion, not scroll position"
  artifacts:
    - path: "public/css/style.css"
      provides: "Wizard-specific CSS: step visibility, navigation bar, product image cards, 44px+ touch targets, tablet responsive breakpoints, wizard error message styling"
      contains: "wizard-nav"
  key_links:
    - from: "public/css/style.css"
      to: "public/js/wizard.js"
      via: "CSS classes applied by wizard.js: .wizard-nav, .wizard-btn, .wizard-btn--back, .wizard-btn--next, .wizard-step-info, .wizard-field-error"
      pattern: "\\.wizard-"
    - from: "public/css/style.css"
      to: "views/index.ejs"
      via: "CSS classes on EJS template elements: .radio-card--with-image, .radio-card-image"
      pattern: "\\.radio-card--with-image"
---

<objective>
Add all wizard-specific CSS: step visibility controls, navigation button styling, product image card layout, 44px+ touch targets, tablet-responsive breakpoints, and wizard error message styling.

Purpose: The wizard architecture (05-01) and content (05-02) are functional but unstyled. This plan makes the wizard visually polished, tablet-optimized, and meets the 44px touch target requirement (WIZ-02).

Output: Updated style.css with comprehensive wizard styling.
</objective>

<execution_context>
@C:/Users/LehnerJ.LEHNER-HAUS/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/LehnerJ.LEHNER-HAUS/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-wizard-ui/05-RESEARCH.md
@.planning/phases/05-wizard-ui/05-01-SUMMARY.md
@.planning/phases/05-wizard-ui/05-02-SUMMARY.md

Key existing file:
@public/css/style.css â€” ~1426 lines, CSS design system with variables, responsive breakpoints at 479/480/768/1024/1280px
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add wizard navigation, product image card, and touch target CSS</name>
  <files>public/css/style.css</files>
  <action>
  Add a new section at the end of style.css (before the final responsive media queries section) with all wizard-specific styles. Use the existing CSS variables (--primary-color, --gray-*, --shadow-*, --radius-*, --transition-*, --font-*, --text-*) for consistency with the design system.

  **Verified CSS variables** (all confirmed present in style.css :root): `--primary-800`, `--error-500`, `--error-50`, `--border-color`, `--transition-slow`, `--transition-fast`, `--transition-normal`, `--radius-lg`, `--radius-sm`, `--text-base`, `--text-sm`, `--text-gray`, `--font-semibold`, `--font-medium`, `--font-family`, `--gray-100`, `--gray-200`, `--gray-700`, `--shadow-md`.

  **1. Wizard Navigation Bar (`.wizard-nav`)**

  ```css
  /* ============================================
     WIZARD NAVIGATION
     ============================================ */
  .wizard-nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 24px 0;
      margin-top: 32px;
      border-top: 1px solid var(--border-color);
  }

  .wizard-btn {
      min-height: 48px;
      min-width: 140px;
      padding: 14px 32px;
      font-size: var(--text-base);
      font-weight: var(--font-semibold);
      font-family: var(--font-family);
      border: none;
      border-radius: var(--radius-lg);
      cursor: pointer;
      transition: all var(--transition-normal);
      touch-action: manipulation;  /* Prevent double-tap zoom delay */
      -webkit-tap-highlight-color: transparent;
  }

  .wizard-btn--next {
      background: var(--primary-color);
      color: white;
  }

  .wizard-btn--next:hover {
      background: var(--primary-800);
      box-shadow: var(--shadow-md);
  }

  .wizard-btn--next:active {
      transform: scale(0.98);
  }

  .wizard-btn--back {
      background: var(--gray-100);
      color: var(--gray-700);
  }

  .wizard-btn--back:hover {
      background: var(--gray-200);
  }

  .wizard-step-info {
      font-size: var(--text-sm);
      color: var(--text-gray);
      font-weight: var(--font-medium);
  }
  ```

  **2. Product Image Cards (`.radio-card--with-image`)**

  ```css
  /* ============================================
     PRODUCT IMAGE CARDS
     ============================================ */
  .radio-card--with-image {
      padding: 0;
      overflow: hidden;
  }

  .radio-card--with-image .radio-card-image {
      width: 100%;
      height: 180px;
      overflow: hidden;
      background: var(--gray-100);
      display: flex;
      align-items: center;
      justify-content: center;
  }

  .radio-card--with-image .radio-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform var(--transition-slow);
  }

  .radio-card--with-image:hover .radio-card-image img {
      transform: scale(1.05);
  }

  .radio-card--with-image .radio-content {
      padding: 20px;
  }

  .radio-card--with-image .checkmark {
      top: 12px;
      right: 12px;
  }
  ```

  **3. Progress Step Indicator Touch Target Enlargement**

  Find the existing `.progress-step-indicator` rules (around line 313) and update:
  - Change `width` and `height` from 28px to 44px
  - Change `font-size` from the current value to var(--text-sm) to fit in the larger circle
  - Keep all other styles (border-radius: 50%, background, transitions)

  Also find `.progress-step` and ensure it has enough spacing for the larger indicators. Add `min-width: 44px` if not present.

  **4. Wizard Validation Error Messages**

  ```css
  /* ============================================
     WIZARD FIELD ERRORS
     ============================================ */
  .wizard-field-error {
      display: block;
      color: var(--error-500);
      font-size: var(--text-sm);
      margin-top: 8px;
      padding: 6px 12px;
      background: var(--error-50);
      border-left: 3px solid var(--error-500);
      border-radius: var(--radius-sm);
      animation: fadeIn var(--transition-fast);
  }

  .radio-group .wizard-field-error {
      margin-top: 12px;
      margin-bottom: 0;
  }

  @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-4px); }
      to { opacity: 1; transform: translateY(0); }
  }
  ```

  **5. Tablet-Responsive Overrides**

  Add/update media query rules within the existing responsive sections:

  At `@media (max-width: 1024px)` (tablet landscape):
  ```css
  .radio-group {
      grid-template-columns: 1fr 1fr;
  }

  .radio-card--with-image .radio-card-image {
      height: 140px;
  }

  .wizard-btn {
      min-width: 120px;
      padding: 12px 24px;
  }
  ```

  At `@media (max-width: 768px)` (tablet portrait / phone):
  ```css
  .radio-group {
      grid-template-columns: 1fr;
  }

  .wizard-nav {
      flex-wrap: wrap;
      gap: 12px;
  }

  .wizard-btn {
      flex: 1;
      min-width: 0;
  }

  .wizard-step-info {
      order: -1;
      width: 100%;
      text-align: center;
      margin-bottom: 4px;
  }
  ```

  At `@media (max-width: 479px)` (small phone):
  ```css
  .radio-card--with-image .radio-card-image {
      height: 120px;
  }
  ```

  **6. Wizard Submit Section**

  The submit section (with id `wizard-submit-section`) needs to be visible only on the last step. The wizard.js handles showing/hiding it. Add CSS:
  ```css
  #wizard-submit-section {
      padding: 24px 0;
  }
  ```

  **7. Form Section Transitions**

  For a polished feel, add a subtle fade when switching steps:
  ```css
  .form-section {
      animation: wizardFadeIn var(--transition-slow) ease;
  }

  @keyframes wizardFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
  }
  ```

  Note: The `form-section` display:none/block is handled by wizard.js. This animation plays when a section becomes visible (display changes from none to block trigger the animation if the keyframe is applied on the class).

  Actually, CSS animations on `display: none -> block` don't replay automatically. To trigger the fade-in, the wizard.js `goToStep()` function should add a class like `.wizard-step-active` when showing a section and the CSS animation should be on `.wizard-step-active`. Add this class to the CSS:
  ```css
  .form-section.wizard-step-active {
      display: block;
      animation: wizardFadeIn var(--transition-slow) ease;
  }
  ```

  And document that wizard.js should use this class when showing sections (add/remove `.wizard-step-active` instead of just toggling display). If wizard.js from 05-01 uses `style.display`, update the CSS approach to work with that pattern instead. The simplest approach: in wizard.js, after setting display=block, also toggle a class. Or just skip the animation and rely on instant step changes (recommended for a sales tool -- speed > animation).

  **Decision: Skip the fade animation.** A sales meeting wizard should feel instant. Do NOT add transition animation on step changes. Just ensure the CSS handles display:none for hidden sections cleanly.

  **IMPORTANT: Do not add `.form-section { display: none; }` in CSS.** The wizard.js controls visibility via inline styles. Adding a CSS rule would hide ALL sections before JS loads, showing a flash of nothing. Let wizard.js handle all display toggling.
  </action>
  <verify>
  - Start server, open in browser, resize to 1024px width (iPad landscape)
  - Verify: No horizontal scrolling
  - Verify: Radio cards show in 2-column grid with images
  - Verify: Weiter/Zuruck buttons are large and easy to tap (min 48px height)
  - Verify: Progress step indicators are 44px circles
  - Verify: Resize to 768px width (iPad portrait) -- cards switch to 1 column
  - Verify: Wizard nav buttons stack gracefully on narrow screens
  - Verify: Validation error messages appear styled in red with left border
  - Open browser dev tools, device emulation -> iPad -> navigate through all 17 steps
  </verify>
  <done>Wizard navigation buttons are styled with 48px minimum height. Progress indicators enlarged to 44px. Product image cards have proper layout with image-above-text. Responsive breakpoints handle tablet and phone widths. Validation errors are styled. No horizontal scrolling on any tablet viewport.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Verify complete wizard UI on tablet and desktop</name>
  <action>Human visual and functional verification of the complete wizard implementation across all plans (05-01 through 05-03).</action>
  <what-built>Complete wizard UI: step-by-step navigation, product images in selection cards, sessionStorage persistence, tablet-optimized layout with 44px+ touch targets, per-step and server-side validation.</what-built>
  <how-to-verify>
  1. Open http://localhost:3000/ in Chrome
  2. Verify only Step 1 (Kontaktdaten) is visible with progress bar and "Weiter" button
  3. Click "Weiter" without filling fields -- expect red validation errors in German
  4. Fill Anrede, Vorname, Nachname, click "Weiter" -- should advance to Step 2 (Haustyp)
  5. Verify Haustyp cards show house images (or placeholders) above text
  6. Navigate through steps 2-11, verify product images appear on catalog-based steps
  7. Select KfW 55 in Step 3 -- verify Step 4 (Wand) shows KFW55 wall options
  8. Press F5 at Step 5 -- verify wizard returns to Step 5 with all previous selections intact
  9. Open Chrome DevTools -> Toggle device toolbar -> iPad (1024x768)
  10. Verify no horizontal scrolling, radio cards in 2-column grid, buttons are large
  11. Complete all steps through Step 17 (Berater), verify submit button is visible
  12. Submit the form -- verify redirect to result page with PDF download
  13. Use browser Back button from result page -- verify wizard navigation works
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
1. Wizard buttons (Weiter/Zuruck) have min-height: 48px -- measurable in browser dev tools
2. Progress step indicators have width/height: 44px -- measurable in dev tools
3. No horizontal scroll on 1024px viewport (iPad landscape)
4. Radio card grid: 2 columns at 1024px, 1 column at 768px
5. Product image cards show image above text with proper object-fit
6. Validation error messages styled with red background and left border
7. All wizard classes (.wizard-nav, .wizard-btn, .wizard-field-error) are styled
</verification>

<success_criteria>
- All interactive elements meet 44px minimum touch target (buttons, progress indicators)
- Responsive layout works at 1024px (iPad), 768px (iPad portrait), 479px (phone)
- Product image cards display correctly with images loading via lazy attribute
- No visual regression in existing form styles
- Wizard feels responsive and instant (no slow animations between steps)
</success_criteria>

<output>
After completion, create `.planning/phases/05-wizard-ui/05-03-SUMMARY.md`
</output>
